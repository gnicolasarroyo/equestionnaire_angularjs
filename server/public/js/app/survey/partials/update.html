<div>
	<h3>{{ title }}</h3>	
</div>
<div>
	<form ng-submit='save(survey)'>
		<div>
			<label for="c-start-date">Start date</label>
			<input type="date" name="start_date" id="c-start-date" ng-model="survey.start_date" value="{{ survey.start_date | date: 'yyyy-MM-dd' }}">
		</div>
		<div>
			<label for="c-effective-days">Effective days</label>
			<input type="number" name="effective_days" id="c-effective-days" ng-model="survey.effective_days" min="1" max="30">
		</div>

		<!-- Questions
		============================-->
		<div>
			<label for="c-title">Title</label>
			<input type="text" name="title" id="c-title" ng-model="survey.title">
		</div>
		<div>
			<label for="c-introduction">Introduction text</label>
			<textarea name="introduction" id="c-introduction" ng-model="survey.introduction"></textarea>
		</div>
		<div>
			<div>
				<h4>Add/Edit question</h4>
				<div>
					<label for="c-query">Query</label>
					<textarea name="query" id="c-query" ng-model="question.query"></textarea>
				</div>
				<div>
					<p>Type</p>
					<label for="c-question_type_text">Text
						<input type="radio" name="question_type" id="c-question_type_text" ng-model="question.question_type" value="1">
					</label>
					<label for="c-question_type_option">Option
						<input type="radio" name="question_type" id="c-question_type_option" ng-model="question.question_type" value="2">
					</label>
					<label for="c-question_type_multipleoption">Multiple option
						<input type="radio" name="question_type" id="c-question_type_multipleoption" ng-model="question.question_type" value="3">
					</label>
				</div>
				<div ng-if="question.question_type != 1">
					<p>Add choice</p>
					<div>
						<label for="c-value">Value</label>
						<input type="text" name="value" id="c-value" ng-model="choice.value">
						<button type="button" ng-click="saveChoice(choice)">Save choice</button>
					</div>
					<div>
						<p>Choices</p>
						<table>
							<tbody>
								<tr ng-repeat="choice in question.choices">
									<td>
										{{ choice.value }}
									</td>
									<td>
										<button type="button" ng-click="deleteChoice(choice)">Delete</button>
									</td>
								</tr>
							</tbody>
						</table>
					</div>
				</div>
				<div>
					<button type="button" ng-click="saveQuestion(question)">Save question</button>
					<button type="button" ng-click="resetQuestion()">Reset</button>
				</div>
			</div>
			<div>
				<h4>Questions</h4>
				<table>
					<tbody>
						<tr ng-repeat="question in survey.questions">
							<td>{{ question.query }}</td>
							<td>{{ question.question_type }}</td>
							<td ng-if="$first && !$last">
								<button type="button" ng-click="downQuestion(question)">Down</button>
							</td>
							<td ng-if="$middle && !$first && !$last">
								<button type="button" ng-click="upQuestion(question)">Up</button>
								<button type="button" ng-click="downQuestion(question)">Down</button>
							</td>
							<td ng-if="$last && !$first">
								<button type="button" ng-click="upQuestion(question)">Up</button>
							</td>
							<td><button type="button" ng-click="editQuestion(question)">Edit</button></td>
							<td><button type="button" ng-click="deleteQuestion(question)">Delete</button></td>
						</tr>
					</tbody>
				</table>
			</div>
		</div>

		<!-- Mail Account Settings
		============================-->
		<div ng-hide="mail_account_settings.length > 0">
			<h5>Mail Account Setting</h5>
			<p>No mail account settings were found, you need to <strong>create a mail account setting</strong> to submit your survey.</p>
		</div>
		<div ng-show="mail_account_settings.length > 0">
			<label for="c-mail-account-setting">Mail Account Setting</label>
			<select ng-model="survey.mail_account_setting">
				<option ng-repeat="mail_account_setting in mail_account_settings" value="{{ mail_account_setting._id }}">{{ mail_account_setting.name }}</option>	
			</select>
		</div>
		
		<!-- Contacts & Contact List
		============================-->
		<div ng-hide="contacts.length > 0">
			<h5>Contacts</h5>
			<p>No contacts were found, you need to <strong>create a contact</strong> to submit your survey.</p>
		</div>
		<div ng-hide="contact_lists.length > 0">
			<h5>Contact lists</h5>
			<p>No contact lists were found, you need to <strong>create a contact list</strong> to submit your survey.</p>
		</div>
		<div ng-show="contacts.length > 0 || contact_lists.length > 0">
			<!-- Available list
			====================================-->
			<div>
				<h5>Contacts & Contact lists available</h5>
				<div>
					<label for="c-only-contact-lists">Only contact lists</label>
					<input type="checkbox" name="only_contact_lists" id="c-only-contact-lists" ng-model="only_contact_lists">		
				</div>
				<div>
					<label for="c-avaibleFilter">Filter</label>
					<input type="text" name="avaibleFilter" id="c-avaibleFilter" ng-model="avaible_filter">
				</div>
				<table>
					<tbody>
						<tr ng-hide="only_contact_lists" ng-repeat="contact in contacts | filter:avaible_filter | orderBy:'name'">
							<td>
								<button type="button" ng-click="avaibleCheckContact(contact)">add</button>
							</td>
							<td>
								<div>Contact</div>
								<div>{{ contact.name }}</div>
								<div>{{ contact.email }}</div>
							</td>
						</tr>
						<tr ng-hide="only_contact_lists">
							<td>----------</td>
							<td>-------------------------</td>
						</tr>
						<tr ng-repeat="contact_list in contact_lists | filter:avaible_filter | orderBy:'name'">
							<td>
								<button type="button" ng-click="avaibleCheckContactList(contact_list)">add</button>
							</td>
							<td>
								<div>Contact list</div>
								<div>{{ contact_list.name }}</div>
								<div>{{ contact_list.contacts.length }} contacts</div>
							</td>
						</tr>
					</tbody>
				</table>
			</div>
			<!-- Selected list
			====================================-->
			<div>
				<h5>Contacts & Contact lists selected</h5>
				<div>
					<label for="c-selectedFilter">Filter</label>
					<input type="text" name="selectedFilter" id="c-selectedFilter" ng-model="selected_filter">
				</div>
				<table>
					<tbody>
						<tr ng-hide="only_contact_lists" ng-repeat="contact in survey.contacts | filter:selected_filter | orderBy:'name'">
							<td>
								<button type="button" ng-click="selectedCheckContact(contact)">Remove</button>
							</td>
							<td>
								<div>Contact</div>
								<div>{{ contact.name }}</div>
								<div>{{ contact.email }}</div>
							</td>
						</tr>
						<tr ng-hide="only_contact_lists">
							<td>----------</td>
							<td>-------------------------</td>
						</tr>
						<tr ng-repeat="contact_list in survey.contact_lists | filter:selected_filter | orderBy:'name'">
							<td>
								<button type="button" ng-click="selectedCheckContactList(contact_list)">Remove</button>
							</td>
							<td>
								<div>Contact list</div>
								<div>{{ contact_list.name }}</div>
								<div>{{ contact_list.contacts.length }} contacts</div>
							</td>
						</tr>
					</tbody>
				</table>
			</div>
		</div>
		<div>
			<input type="submit" value="Save">
			 - 
			<a href="{{ links.back_to_list }}">Back to list</a>
		</div>
	</form>
</div>